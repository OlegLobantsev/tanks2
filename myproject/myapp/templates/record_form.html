{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">{% if object %}Редактирование{% else %}Создание{% endif %} записи</h1>

    <!-- Форма -->
    <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
        {% csrf_token %}

        <!-- Номер вагона -->
        <div class="mb-3">
            <label for="id_number" class="form-label">Номер вагона:</label>
            {{ form.number }}
            <div class="invalid-feedback">
                Пожалуйста, введите номер вагона.
            </div>
        </div>

        <!-- Вес -->
        <div class="mb-3">
            <label for="id_weight" class="form-label">Вес:</label>
            {{ form.weight }}
            <div class="invalid-feedback">
                Пожалуйста, введите вес.
            </div>
        </div>

        <!-- Квитанция -->
        <div class="mb-3">
            <label for="id_file1" class="form-label">Квитанция:</label>
            {{ form.file1 }}
        </div>

        <!-- Дата по накладной -->
        <div class="mb-3">
            <label for="id_date_delivery" class="form-label">Дата по накладной:</label>
            <input type="datetime-local" class="form-control" id="id_date_delivery" name="date_delivery"
                   value="{{ form.date_delivery.value|date:'Y-m-d\TH:i' }}" required>
            <div class="invalid-feedback">
                Пожалуйста, введите дату по накладной.
            </div>
        </div>

        <!-- Дата прибытия на станцию -->
        <div class="mb-3">
            <label for="id_date_submission" class="form-label">Дата прибытия на станцию:</label>
            <input type="datetime-local" class="form-control" id="id_date_submission" name="date_submission"
                   value="{{ form.date_submission.value|date:'Y-m-d\TH:i' }}" required>
            <div class="invalid-feedback">
                Пожалуйста, введите дату прибытия на станцию.
            </div>
        </div>

        <!-- Дата подачи на базу -->
        <div class="mb-3">
            <label for="id_submission_to_database" class="form-label">Дата подачи на базу:</label>
            <input type="datetime-local" class="form-control" id="id_submission_to_database" name="submission_to_database"
                   value="{{ form.submission_to_database.value|date:'Y-m-d\TH:i' }}" required>
            <div class="invalid-feedback">
                Пожалуйста, введите дату подачи на базу.
            </div>
        </div>

        <!-- Уведомление о завершении грузовой операции -->
        <div class="mb-3">
            <label for="id_shipment_date_time" class="form-label">Уведомление о завершении грузовой операции:</label>
            <input type="datetime-local" class="form-control" id="id_shipment_date_time" name="shipment_date_time"
                   value="{{ form.shipment_date_time.value|date:'Y-m-d\TH:i' }}" required>
            <div class="invalid-feedback">
                Пожалуйста, введите дату уведомления.
            </div>
        </div>

        <!-- Дата уборки -->
        <div class="mb-3">
            <label for="id_withdrawal_from_bases" class="form-label">Дата уборки:</label>
            <input type="datetime-local" class="form-control" id="id_withdrawal_from_bases" name="withdrawal_from_bases"
                   value="{{ form.withdrawal_from_bases.value|date:'Y-m-d\TH:i' }}" required>
            <div class="invalid-feedback">
                Пожалуйста, введите дату уборки.
            </div>
        </div>

        <!-- Акт приемосдатчика -->
        <div class="mb-3">
            <label for="id_file2" class="form-label">Акт приемосдатчика:</label>
            {{ form.file2 }}
        </div>

        <!-- Претензия -->
        <div class="mb-3">
            <label for="id_file3" class="form-label">Претензия:</label>
            {{ form.file3 }}
        </div>

        <!-- Претензия РЖД -->
        <div class="mb-3">
            <label for="id_file4" class="form-label">Претензия РЖД:</label>
            {{ form.file4 }}
        </div>

        <!-- Кнопки -->
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">Сохранить</button>
            <a href="/" class="btn btn-secondary">Отмена</a>
        </div>
    </form>
</div>

<!-- Стили для формы -->
<style>
    .form-label {
        font-weight: bold;
    }
    .form-control {
        border-radius: 5px;
        border: 1px solid #ced4da;
    }
    .btn {
        border-radius: 5px;
    }
    .needs-validation .form-control:invalid {
        border-color: #dc3545;
    }
    .needs-validation .form-control:valid {
        border-color: #28a745;
    }
</style>

<!-- Валидация формы -->
<script>
    (function () {
        'use strict'

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll('.needs-validation')

        // Loop over them and prevent submission
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }

                    form.classList.add('was-validated')
                }, false)
            })
    })()
</script>
{% endblock %}